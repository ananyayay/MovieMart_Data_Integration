-- Drop Table TMDB_GENRE if it exists
DROP TABLE IF EXISTS TMDB_GENRE;

-- Drop Table TMDB_MOVIE_GENRE if it exists
DROP TABLE IF EXISTS TMDB_MOVIE_GENRE;

-- Drop Table TMDB_MOVIE if it exists
DROP TABLE IF EXISTS TMDB_MOVIE;


-- Table TMDB_GENRE
CREATE TABLE TMDB_GENRE (
    ID INT PRIMARY KEY,
    GENREID INT,
    GENRE VARCHAR(255)
);

-- Table TMDB_MOVIE_GENRE
CREATE TABLE TMDB_MOVIE_GENRE (
    ID INT PRIMARY KEY,
    FILMID INT,
    GENREID INT
);

-- Table TMDB_MOVIE
CREATE TABLE TMDB_MOVIE (
    ID INT PRIMARY KEY,
    FILMID INT,
    TITLE VARCHAR(255),
    ADULT BOOLEAN,
    BACKDROP_PATH VARCHAR(255),
    BUDGET INT,
    HOMEPAGE VARCHAR(255),
    IMDB_ID VARCHAR(20),
    ORIGINAL_LANGUAGE VARCHAR(10),
    ORIGINAL_TITLE VARCHAR(255),
    OVERVIEW TEXT,
    POPULARITY FLOAT,
    POSTER_PATH VARCHAR(255),
    RELEASE_DATE DATE,
    REVENUE DECIMAL(15, 2),
    RUNTIME INT,
    VOTE_AVERAGE FLOAT,
    VOTE_COUNT INT,
    STATUS_ VARCHAR(20),
    TAGLINE TEXT,
    COLLECTIONID INT
);

drop view if exists TMDB_MOVIE_AND_GENRE;
CREATE OR REPLACE VIEW TMDB_MOVIE_AND_GENRE AS
SELECT
    TM.TITLE AS Title,
    TM.POSTER_PATH AS image,
    TM.OVERVIEW AS overview,
    TG.GENRE AS Genre
FROM
    TMDB_MOVIE AS TM
JOIN
    TMDB_MOVIE_GENRE AS TMG ON TM.FILMID = TMG.FILMID
JOIN
    TMDB_GENRE AS TG ON TMG.GENREID = TG.GENREID;

